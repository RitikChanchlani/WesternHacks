def function1(word_list, keyword_value_list):
    keyword_count = 0
    total_score = 0
    for word in word_list:
        for keyword_pairing in keyword_value_list:
            if word == keyword_pairing[0]:
                keyword_count += 1
                total_score += keyword_pairing[1]
    if keyword_count > 0:
        score = total_score / keyword_count
        return score
    else:
        return "no results"

def results(average1, keyword_count1, count1):
    try:
        r_tuple = ("%.2f"%average1, keyword_count1, count1)
    except UnboundLocalError:
        r_average = 0
        r_tuple = (average1, keyword_count1, count1)
    return r_tuple

def function2(file, keyword_file):
    keyword_list = []
    stripped_kh_pair = []
    stripped_info = []

    count = 0
    total_score = 0
    average = 0
    keyword_count = 0
    total_count = 0

    try:
        # keywords file (code from assignment document)
        keywordfile = open(keyword_file,"r",encoding="utf-8")

        for line in keywordfile:
            count += 1
            keyword_happiness_pair = line.split(",")

            # strip /n from number
            for word in keyword_happiness_pair:
                stripped_kh_pair.append(word.strip())
            # convert happiness value to integer
            stripped_kh_pair[1] = int(stripped_kh_pair[1])

            keyword_list.append(stripped_kh_pair)

            # resets so that the previous pair is not appended again
            stripped_kh_pair = []
        # closes keywords file
        keywordfile.close()

        file = open(file,"r",encoding="utf-8")

        for line in file:
            total_count += 1
            info = line.split()

            for element in info:
                stripped_element = element.strip(" !@#$%^&*()-_+=;:\"\'/.>,<{[}]|\\~`")
                stripped_info.append(stripped_element)

            while "" in stripped_info:
                stripped_info.remove("")
            # word_list is a list of each word in lowercase with no punctuation
            word_list = [word.lower() for word in stripped_info]


            results = function1(word_list, keyword_list)

            if results != "no results":
                total_score += results
                keyword_count += 1
                average = total_score / keyword_count

            stripped_info = []

        file.close()

    except IOError:
        return "IOError"
    # returns a list of tuples
    tuple = (round(average, 2), keyword_count, count)

    return tuple


text = input("Please enter the name of the text file.")
keyword = input("Please enter the name of the keyword file.")

final_results = function2(text, keyword)
# empty list is returned by function2 in the case of IOError

if final_results != "IOError":
    print("\nResults:")
    print("Average score:", final_results[0])
    print("Number of keyword texts:", final_results[1])
    print("Total number:", final_results[2])
else:
    print("\nPlease try again.")
